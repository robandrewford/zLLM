flowchart LR

%%{init: {'theme':'dark'}}%%

A("Query")
L(("LLM\n&nbsp;Router&nbsp;"))
A4("Options")
%%A5(("Auto\n&nbspcorrect&nbsp;"))
Z2("Sub-LLM\nCorpus")
Z("Action")
B("Subquery")
A2("Frontend\nParams")
E("Embeddings,\nRelevancy\nScores")
CX("Context\nTables")
DT("Multitoken\nDictionary")
J("Multitokens\n(DB Keys)")
CT("Sorted\nn-grams")
Q(("Finetune"))
V("Related\nMultitokens")
S("URLs\nText\nImages\nCategories\nTags\nFiles")

X0(" ")
X6(" ")
X4(" ")
X3(" ")
X7(" ")
%%subgraph glue [ ]
%%direction LR
subgraph glue [ ]
direction LR

subgraph head [ ]
%%X0
subgraph head1 [<font color=#ffcc00 size=+1>Prompt]
%%A4
L
A
end
A4
%%A5
end

%% glue [ ]
subgraph major [<font color=#ffcc00 size=+1>Retrieval]
%%X3
subgraph init [ ]
Z2
B
Z
end
subgraph init2 [ ]
CT
A2
end
subgraph init3 [ ]
J
%%X6
end
subgraph init4 [ ]
E
DT
CX
end
end

subgraph results [ ]
Q
subgraph rrf ["<font color=#ffcc00 size=+1>Results</font>"]
V
S
end
end
end
L --- Z2
A --- Z2
A --- B
A --- Z
Z2 --- CT
init2 -- search --- J
B -- sort --- CT
J --- E
J --- CX
J --- DT
Z --- CX
init2 -.- Q
DT -- weights --- S
CX -- weights --- S
E -- rank --- V
DT -- weights --- V

%% real time fine-tuning of Enterprise LLMs
%% queries subqueries autocorrect
%% word pairs also uses categories tags
%% llm router
%% contextual pairs
%% scores
%% subqueries, frontend hyperparameters, autocorrect

style J  fill:#0066aa,color:#ffffff,stroke:#555555
style A  fill:#0066aa,color:#ffffff,stroke:#555555
style A2 fill:#000000,color:#ffffff,stroke:#000000
style A4 fill:#000000,color:#ffffff,stroke:#000000
%%style A5 fill:#000000,color:#ffffff,stroke:#000000
style B  fill:#0066aa,color:#ffffff,stroke:#555555
style Z  fill:#0066aa,color:#ffffff,stroke:#555555
style Z2 fill:#0066aa,color:#ffffff,stroke:#555555

style L fill:#000000,color:#ffffff,stroke:#000000
style Q fill:#ffaa00,color:#000000,stroke:#555555
style V fill:#0066aa,color:#ffffff,stroke:#555555
style S fill:#0066aa,color:#ffffff,stroke:#555555

style CT fill:#990000,color:#ffffff,stroke:#555555
style CX fill:#006600,color:#ffffff,stroke:#555555
style DT fill:#006600,color:#ffffff,stroke:#555555
style E  fill:#990000,color:#ffffff,stroke:#555555

style X0 fill:#000000,height:0px,font-size:0,stroke-width:0px
style X4 fill:#000000,height:0px,font-size:0,stroke-width:0px
style X3 fill:#000000,width:0px,height:28px,font-size:0,stroke-width:0px
style X6 fill:#000000,height:0px,font-size:0,stroke-width:0px
style X7 fill:#000000,height:0px,font-size:0,stroke-width:0px

style head    fill:#777777,stroke:#fff,stroke-width:0px,font-size:15px
style head1   fill:#555555,stroke:#fff,stroke-width:0px,font-size:15px
style glue    fill:#000000,width:1400px,height650px,stroke:#000,stroke-width:0px,font-size:15px
style results fill:#777777,width:190px,stroke:#fff,stroke-width:0px,font-size:15px
style major   fill:#000000,stroke:#000,stroke-width:0px,font-size:15px
style init    fill:#000000,stroke:#fff,stroke-width:0px,font-size:15px
style init2   fill:#555555,stroke:#000,stroke-width:1px,font-size:15px
style init3   fill:#000000,stroke:#fff,stroke-width:0px,font-size:15px
style init4   fill:#000000,stroke:#fff,stroke-width:0px,font-size:15px
style rrf     fill:#555555,stroke:#fff,stroke-width:0px,font-size:15px

linkStyle 0 stroke:#FF0000,fill:none
linkStyle 1 stroke:#FF0000,fill:none
linkStyle 2 stroke:#FF0000,fill:none
linkStyle 3 stroke:#FF0000,fill:none
linkStyle 4 stroke:#FF0000,fill:none
linkStyle 5 stroke:#ff0000,fill:none
linkStyle 6 stroke:#FF0000,fill:none
linkStyle 7 stroke:#FF0000,fill:none
linkStyle 8 stroke:#FF0000,fill:none
linkStyle 9 stroke:#FF0000,fill:none
linkStyle 10 stroke:#FF0000,fill:none
%%linkStyle 11 stroke:#FF0000,fill:none
linkStyle 12 stroke:#FF0000,fill:none
linkStyle 13 stroke:#FF0000,fill:none
linkStyle 14 stroke:#FF0000,fill:none
linkStyle 15 stroke:#FF0000,fill:none
